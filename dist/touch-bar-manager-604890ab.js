"use strict";var t=require("electron");const{TouchBar:e,nativeImage:o}=t.remote,{TouchBarButton:n}=e;exports.TouchBarManager=class{constructor(){this.buttons=[]}destroy(){this.buttons=[],this.update()}addButton(t){this.buttons.length>=7||this._renderButton(t).then(e=>{const o=new n({icon:e,click:t._onClick.bind(t,{})});this.buttons.push({priority:t.priority?t.priority:0,touchButton:o,group:t.group}),this.update()})}update(){this._updateDebounce&&clearTimeout(this._updateDebounce),this._updateDebounce=setTimeout(()=>this._setTouchBar(),100)}removeGroup(t){this.buttons=this.buttons.filter(e=>e.group!==t),this.update()}_renderButton(t){return document.fonts.ready.then(()=>{if(!(t.element instanceof HTMLElement))return;const e=window.getComputedStyle(t.element,":before"),n=e.content.replace(/["']/g,"");let r=document.createElement("canvas");r.width=120,r.height=120;let i=r.getContext("2d");i.textAlign="center",i.textBaseline="top",i.fillStyle=t.enabled?"#fff":"#aaa",i.font="88px "+e.fontFamily,i.fillText(n,r.width/2,(r.height-88)/2);const u=o.createEmpty();return u.addRepresentation({dataURL:r.toDataURL(),scaleFactor:2,width:44,height:44}),u})}_setTouchBar(){const t=this.buttons.sort((t,e)=>t.priority-e.priority).map(t=>t.touchButton);let o=new e({items:t});atom.getCurrentWindow().setTouchBar(o),this._updateDebounce=null}};
//# sourceMappingURL=touch-bar-manager-604890ab.js.map
